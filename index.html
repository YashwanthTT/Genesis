<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akruti - A Celebration of Indian Folk Art</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #A45C40; /* Desert Sun */
            transition: width 0.3s;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }
        
        /* SLIDESHOW STYLES */
        .slider {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
            border-radius: 1rem;
        }
        .slider img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            animation: slide 9s infinite;
        }
        .slider img:nth-child(2) { animation-delay: 1.5s; }
        .slider img:nth-child(3) { animation-delay: 3s; }
        .slider img:nth-child(4) { animation-delay: 4.5s; }
        .slider img:nth-child(5) { animation-delay: 6s; }
        .slider img:nth-child(6) { animation-delay: 7.5s; }

        @keyframes slide {
            0% { opacity: 0; transform: scale(1.05); }
            16.66% { opacity: 1; transform: scale(1); }
            33.33% { opacity: 0; transform: scale(1.05); }
            100% { opacity: 0; }
        }

        /* Splash Screen Styles */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #e4b7a0;
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease-out;
        }
        #splash-logo {
            width: 250px;
            height: auto;
            transition: all 0.5s ease-in-out;
        }
        .app-content {
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        .loaded .app-content {
            opacity: 1;
        }
        .loaded #splash-screen {
            opacity: 0;
            pointer-events: none;
        }

        /* Custom Toast Notification */
        #toast {
            position: fixed;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 9999px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: bottom 0.5s ease-in-out;
            z-index: 200;
        }
        #toast.show {
            bottom: 20px;
        }
        #toast.success {
            background-color: #28a745;
        }
        #toast.error {
            background-color: #dc3545;
        }
    </style>
</head>
<body class="bg-[#F6EEE0] text-[#A45C40]">

    <!-- Splash Screen -->
    <div id="splash-screen">
        <img id="splash-logo" src="a.logo.png" alt="Akruti Logo" onerror="this.onerror=null;this.src='https://placehold.co/250x250/e4b7a0/A45C40?text=Akruti';">
    </div>
    
    <!-- Toast Notification -->
    <div id="toast"></div>

    <div class="app-content">
        <!-- Header -->
        <header class="bg-white/80 backdrop-blur-sm shadow-md sticky top-0 z-50">
            <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
                <a href="#" id="home-link" class="flex items-center text-2xl font-bold text-[#A45C40] cursor-pointer">
                    <img src="a.logo.png" alt="Akruti Logo" class="h-20 mr-2" onerror="this.onerror=null;this.src='https://placehold.co/64x64/e4b7a0/A45C40?text=A';">
                </a>
                
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#home-page-section" data-action="show-home" class="nav-link text-[#A45C40] hover:text-[#C38370] font-medium">Home</a>
                    <a href="#" data-action="show-art-forms" class="nav-link text-[#A45C40] hover:text-[#C38370] font-medium">Art Forms</a>
                    <a href="#" data-action="show-artists" class="nav-link text-[#A45C40] hover:text-[#C38370] font-medium">Artists</a>
                    <a href="#" data-action="show-events" class="nav-link text-[#A45C40] hover:text-[#C38370] font-medium">Events</a>
                </div>

                <!-- Search Bar -->
                <div class="hidden md:flex flex-grow max-w-lg mx-4">
                    <input type="search" id="search-input" placeholder="Search for artist, art, or culture..." class="w-full px-4 py-2 border border-[#E4B7A0] rounded-l-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition bg-white">
                    <button id="search-btn" data-action="search" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-r-lg">
                        <i class="fas fa-search"></i>
                    </button>
                </div>

                <!-- AUTHENTICATION-AWARE NAVIGATION -->
                <div class="hidden md:flex items-center space-x-4" id="nav-right-desktop">
                    <!-- Logged Out State -->
                    <div id="logged-out-view" class="flex items-center space-x-4">
                        <button data-action="show-login" class="text-[#A45C40] hover:text-[#C38370] font-medium">Login</button>
                        <button data-action="creator-hub" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-full transition duration-300">Creator Hub</button>
                    </div>
                    <!-- Logged In State (hidden by default) -->
                    <div id="logged-in-view" class="hidden items-center space-x-4">
                        <span id="user-email" class="text-sm text-[#C38370] truncate max-w-[150px]" title="Logged in user"></span>
                        <button data-action="creator-hub" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-full transition duration-300">My Hub</button>
                        <button data-action="logout" class="text-[#A45C40] hover:text-[#C38370] font-medium">Logout</button>
                    </div>
                </div>
                <button id="mobile-menu-button" class="md:hidden">
                    <i class="fas fa-bars text-2xl text-[#A45C40]"></i>
                </button>
            </nav>
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
                <a href="#home-page-section" data-action="show-home" class="block py-2 text-[#A45C40] hover:text-[#C38370]">Home</a>
                <a href="#" data-action="show-art-forms" class="block py-2 text-[#A45C40] hover:text-[#C38370]">Art Forms</a>
                <a href="#" data-action="show-artists" class="block py-2 text-[#A45C40] hover:text-[#C38370]">Artists</a>
                <a href="#" data-action="show-events" class="block py-2 text-[#A45C40] hover:text-[#C38370]">Events</a>
                <div id="nav-right-mobile" class="mt-4 border-t border-[#E4B7A0] pt-4">
                     <!-- Logged Out State -->
                    <div id="logged-out-view-mobile">
                        <button data-action="show-login" class="block w-full text-left py-2 text-[#A45C40] hover:text-[#C38370]">Login</button>
                        <button data-action="creator-hub" class="block w-full mt-2 bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-full text-center">Creator Hub</button>
                    </div>
                     <!-- Logged In State (hidden by default) -->
                    <div id="logged-in-view-mobile" class="hidden">
                        <span id="user-email-mobile" class="block py-2 text-sm text-[#C38370] truncate"></span>
                        <button data-action="creator-hub" class="block w-full mt-2 bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-full text-center">My Hub</button>
                        <button data-action="logout" class="block w-full text-left py-2 mt-2 text-[#A45C40] hover:text-[#C38370]">Logout</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Back Button -->
        <button id="back-btn" data-action="go-back" class="hidden fixed bottom-8 right-8 bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-3 px-4 rounded-full transition duration-300 z-50 shadow-lg">
            <i class="fas fa-arrow-left"></i>
        </button>

        <!-- MAIN CONTENT WRAPPER -->
        <div id="main-content">
            
            <!-- =================================== -->
            <!-- ==       HOME PAGE CONTENT       == -->
            <!-- =================================== -->
            <main id="home-page">
                <!-- Hero Section -->
                <section id="home-page-section" class="h-[50vh] md:h-[70vh] p-4 md:p-8 relative">
                      <div class="slider h-full">
                          <img src="landing.chitara.jpg" alt="Indian Art Slide 1" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Chitara+Art';">
                          <img src="landing.art.png" alt="Indian Art Slide 2" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Pithora+Art';">
                          <img src="landing.embroidery.png" alt="Indian Art Slide 3" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Embroidery';">
                          <img src="landing.madhubani.jpg" alt="Indian Art Slide 4" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Madhubani';">
                          <img src="landing.pithora.jpg" alt="Indian Art Slide 5" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Pithora+Art';">
                          <img src="landing.warli.jpg" alt="Indian Art Slide 6" onerror="this.onerror=null;this.src='https://placehold.co/1200x800/A45C40/F6EEE0?text=Warli+Art';">
                      </div>
                      <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center text-center rounded-2xl">
                          <div>
                              <img src="VSVY.png" alt="Akruti Logo" class="mx-auto h-80 md:h-108 drop-shadow-lg">
                              <p class="text-white text-lg md:text-2xl mt-4 drop-shadow-md">A Digital Sanctuary for India's Folk & Tribal Art</p>
                          </div>
                      </div>
                </section>

                <!-- Featured Art Forms Section -->
                <section id="featured-art-forms" class="py-16 bg-white/70">
                    <div class="container mx-auto px-6 text-center">
                        <h2 class="text-3xl font-bold mb-4">Featured Art Forms</h2>
                        <p class="text-[#C38370] max-w-2xl mx-auto mb-12">A glimpse into the rich tapestry of India's artistic heritage.</p>
                        <div id="featured-art-container" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <!-- Featured art cards will be injected here by JS -->
                        </div>
                    </div>
                </section>
            </main>

            <!-- =================================== -->
            <!-- ==     ART FORMS PAGE CONTENT    == -->
            <!-- =================================== -->
            <main id="art-forms-page" class="hidden bg-white/70">
                <div class="container mx-auto px-6 py-20">
                    <div class="max-w-3xl mx-auto text-center">
                        <h1 class="text-4xl font-bold mb-4">India's Endangered Artistic Heritage</h1>
                        <p class="text-[#C38370] mb-12">Discover the stories behind traditional art forms that are on the brink of extinction. Your appreciation and support can help keep these invaluable cultural treasures alive.</p>
                    </div>

                    <!-- UPDATED: Filter Section -->
                    <div class="bg-[#F6EEE0]/80 backdrop-blur-sm p-6 rounded-lg shadow-md mb-12 sticky top-24 z-40">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <select id="status-filter" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition">
                                <option value="all">Filter by Status</option>
                                <option value="critically-endangered">Critically Endangered</option>
                                <option value="severely-endangered">Severely Endangered</option>
                                <option value="endangered">Endangered</option>
                                <option value="vulnerable">Vulnerable</option>
                                <option value="nearly-extinct">Nearly Extinct</option>
                            </select>
                            <select id="state-filter" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition">
                                <option value="all">Filter by State</option>
                            </select>
                            <button id="filter-btn" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center">
                                <i class="fas fa-filter mr-2"></i> Filter Results
                            </button>
                        </div>
                    </div>

                    <div id="art-forms-container" class="space-y-16">
                        <!-- Art forms content will be populated here -->
                    </div>
                </div>
            </main>
            
            <!-- =================================== -->
            <!-- ==      ARTISTS PAGE CONTENT     == -->
            <!-- =================================== -->
            <main id="artists-page" class="hidden">
                <div class="container mx-auto px-6 py-20">
                    <div class="max-w-3xl mx-auto text-center">
                        <h1 class="text-4xl font-bold mb-4">Our Talented Artists</h1>
                        <p class="text-[#C38370] mb-12">Discover and connect with the creators preserving India's artistic legacy.</p>
                    </div>
                    <div id="artists-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Artist profiles will be injected here by JS -->
                    </div>
                </div>
            </main>

            <!-- =================================== -->
            <!-- ==    ART FORM DETAIL PAGE CONTENT == -->
            <!-- =================================== -->
            <main id="art-detail-page" class="hidden">
                <div class="container mx-auto px-6 py-20">
                    <div class="max-w-5xl mx-auto">
                        <h1 id="art-detail-title" class="text-4xl md:text-5xl font-bold text-center mb-8">Art Form Name</h1>
                        <div class="bg-white rounded-lg shadow-xl overflow-hidden">
                            <div class="w-full h-[40vh] md:h-[60vh] bg-black">
                                <video id="art-detail-video" class="w-full h-full object-contain" controls poster="">
                                    <source src="https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" type="video/mp4">
                                </video>
                            </div>
                            <div class="p-8 md:p-12">
                                <div id="art-detail-description" class="prose max-w-none text-[#A45C40]">
                                    <!-- Detailed description will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- =================================== -->
            <!-- ==      EVENTS PAGE CONTENT      == -->
            <!-- =================================== -->
            <main id="events-page" class="hidden bg-white/70">
                <div class="container mx-auto px-6 py-20">
                    <div class="max-w-3xl mx-auto text-center">
                        <h1 class="text-4xl font-bold mb-4">Cultural Events</h1>
                        <p class="text-[#C38370] mb-8">Discover workshops, exhibitions, and performances happening around you.</p>
                        <div class="max-w-2xl mx-auto space-y-4">
                            <div class="flex">
                                <input type="text" id="city-search-input" placeholder="Enter a city name..." class="w-full px-4 py-3 border border-[#E4B7A0] rounded-l-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition bg-white">
                                <button id="find-events-by-city-btn" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-3 px-4 rounded-r-lg">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>

                            <button id="find-events-btn" class="bg-[#A45C40]/80 hover:bg-[#A45C40] text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300">
                                <i class="fas fa-map-marker-alt mr-2"></i> Or, Find Events Near Me
                            </button>
                        </div>
                    </div>

                    <div id="events-container" class="mt-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Event cards will be populated here by JavaScript -->
                    </div>
                </div>
            </main>

            <!-- =================================== -->
            <!-- ==    SEARCH RESULTS PAGE CONTENT  == -->
            <!-- =================================== -->
            <main id="search-results-page" class="hidden">
                <div class="container mx-auto px-6 py-20">
                    <h1 class="text-3xl font-bold text-center mb-12">Search Results</h1>
                    <div id="search-results-container" class="space-y-8 max-w-4xl mx-auto">
                        <!-- Search results will be injected here -->
                    </div>
                </div>
            </main>

            <!-- =================================== -->
            <!-- ==       LOGIN PAGE CONTENT      == -->
            <!-- =================================== -->
            <main id="login-page" class="hidden">
                <div class="container mx-auto px-6 py-20 flex items-center justify-center min-h-[70vh]">
                    <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-md">
                        <h2 id="auth-title-page" class="text-2xl font-bold text-[#A45C40] text-center mb-6">Login</h2>
                        <div id="auth-error-page" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 hidden"></div>
                        
                        <!-- Google Login Button -->
                        <button data-action="login-google" class="w-full bg-white border border-gray-300 text-gray-700 font-semibold py-3 px-4 rounded-full transition duration-300 hover:bg-gray-100 flex items-center justify-center mb-4">
                            <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google logo" class="h-5 mr-3">
                            Continue with Google
                        </button>

                        <div class="my-6 flex items-center">
                            <hr class="flex-grow border-t border-gray-300">
                            <span class="mx-4 text-gray-500">OR</span>
                            <hr class="flex-grow border-t border-gray-300">
                        </div>

                        <!-- Login Form -->
                        <form id="login-form-page">
                            <div class="mb-4">
                                <label for="login-email-page" class="block text-[#A45C40] mb-2">Email</label>
                                <input type="email" id="login-email-page" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40]" required>
                            </div>
                            <div class="mb-6">
                                <label for="login-password-page" class="block text-[#A45C40] mb-2">Password</label>
                                <input type="password" id="login-password-page" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40]" required>
                            </div>
                            <button type="submit" class="w-full bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-3 px-4 rounded-full transition duration-300">Login</button>
                        </form>

                        <!-- Sign Up Form -->
                        <form id="signup-form-page" class="hidden">
                             <div class="mb-4">
                                <label for="signup-email-page" class="block text-[#A45C40] mb-2">Email</label>
                                <input type="email" id="signup-email-page" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40]" required>
                            </div>
                            <div class="mb-6">
                                <label for="signup-password-page" class="block text-[#A45C40] mb-2">Password (min. 6 characters)</label>
                                <input type="password" id="signup-password-page" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40]" required>
                            </div>
                            <button type="submit" class="w-full bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-3 px-4 rounded-full transition duration-300">Create Account</button>
                        </form>

                        <p class="text-center mt-6">
                            <span id="auth-prompt-text-page">Don't have an account?</span>
                            <button id="toggle-auth-mode-page" class="text-[#A45C40] hover:underline font-semibold">Sign Up</button>
                        </p>
                    </div>
                </div>
            </main>

            <!-- =================================== -->
            <!-- ==     CREATOR HUB CONTENT       == -->
            <!-- =================================== -->
            <main id="creator-hub-page" class="hidden bg-white/70">
                <div class="container mx-auto px-6 py-20">
                    <div class="max-w-3xl mx-auto text-center">
                        <h1 class="text-4xl font-bold mb-4">Creator Hub</h1>
                        <p class="text-[#C38370] mb-12">This is your creative space. Fill out the sections below to build and publish your public artist profile.</p>
                    </div>

                    <form id="creator-profile-form" class="max-w-3xl mx-auto space-y-12">
                        <!-- Artist Details Card -->
                        <div class="bg-[#F6EEE0] p-8 rounded-lg shadow-md">
                            <h2 class="text-2xl font-bold mb-6">1. My Details</h2>
                            <div class="space-y-6">
                                <div>
                                    <label for="full-name" class="block font-medium text-[#A45C40] mb-2">Full Name</label>
                                    <input type="text" id="full-name" name="fullName" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition" placeholder="e.g., Sunita Devi">
                                </div>
                                <div>
                                    <label for="profile-picture-url" class="block font-medium text-[#A45C40] mb-2">Profile Picture URL</label>
                                    <input type="url" id="profile-picture-url" name="profilePictureUrl" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition" placeholder="https://example.com/your-photo.jpg">
                                </div>
                                <div>
                                    <label for="artist-quote" class="block font-medium text-[#A45C40] mb-2">Short Quote or Bio</label>
                                    <textarea id="artist-quote" name="artistQuote" rows="3" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition" placeholder="e.g., 'I am a canvas painter i teach for the student of a international school in banglore.'"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- My Services (Gigs) Card -->
                        <div class="bg-[#F6EEE0] p-8 rounded-lg shadow-md">
                            <h2 class="text-2xl font-bold mb-6">2. My Services (Gigs)</h2>
                            <p class="text-[#C38370] mb-6">Create specific services that clients can order. This is the core of your artist profile.</p>
                            
                            <!-- List of existing gigs -->
                            <div id="gigs-list" class="space-y-4 mb-6">
                                <!-- Gigs will be dynamically added here -->
                            </div>
                            
                            <button type="button" id="add-gig-btn" class="w-full bg-[#E4B7A0]/50 text-[#A45C40] font-bold py-3 px-4 rounded-lg hover:bg-[#E4B7A0] transition duration-300">
                                + Add a New Service
                            </button>

                            <!-- Form for adding/editing a gig (initially hidden) -->
                            <div id="gig-form-container" class="mt-8 space-y-6 border-t border-[#E4B7A0] pt-6 hidden">
                                <h3 class="text-xl font-bold">Create a New Service</h3>
                                 <div>
                                    <label for="gig-title" class="block font-medium text-[#A45C40] mb-2">Service Title</label>
                                    <input type="text" id="gig-title" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition" placeholder="e.g., I will create a custom Madhubani painting for your home">
                                </div>
                                <div>
                                    <label for="gig-description" class="block font-medium text-[#A45C40] mb-2">Service Description</label>
                                    <textarea id="gig-description" rows="4" class="w-full px-4 py-2 border border-[#E4B7A0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#A45C40] transition" placeholder="Describe what you offer, the process, and what the client will receive."></textarea>
                                </div>
                                
                                <h4 class="text-lg font-bold pt-4 border-b border-[#E4B7A0] pb-2">Pricing Tiers</h4>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <!-- Basic Tier -->
                                    <div class="border border-[#E4B7A0] p-4 rounded-lg">
                                        <h5 class="font-bold text-center mb-2">Basic</h5>
                                        <input type="text" id="basic-price" class="w-full mb-2 px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Price (e.g., 3000)">
                                        <textarea id="basic-desc" rows="3" class="w-full px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Description (e.g., 1 concept, 2 revisions)"></textarea>
                                    </div>
                                    <!-- Standard Tier -->
                                    <div class="border-2 border-[#A45C40] p-4 rounded-lg">
                                        <h5 class="font-bold text-center mb-2 text-[#A45C40]">Standard</h5>
                                        <input type="text" id="standard-price" class="w-full mb-2 px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Price (e.g., 5000)">
                                        <textarea id="standard-desc" rows="3" class="w-full px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Description (e.g., 2 concepts, 4 revisions)"></textarea>
                                    </div>
                                    <!-- Premium Tier -->
                                    <div class="border border-[#E4B7A0] p-4 rounded-lg">
                                        <h5 class="font-bold text-center mb-2">Premium</h5>
                                        <input type="text" id="premium-price" class="w-full mb-2 px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Price (e.g., 8000)">
                                        <textarea id="premium-desc" rows="3" class="w-full px-3 py-1 border border-[#E4B7A0] rounded-md text-sm" placeholder="Description (e.g., 3 concepts, unlimited revisions)"></textarea>
                                    </div>
                                </div>
                                <div class="flex justify-end space-x-4">
                                    <button type="button" id="cancel-gig-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full">Cancel</button>
                                    <button type="button" id="save-gig-btn" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-2 px-4 rounded-full">Save Service</button>
                                </div>
                            </div>
                        </div>

                        <!-- Save Button -->
                        <div class="flex justify-center pt-8">
                            <button type="submit" id="save-profile-btn" class="bg-[#A45C40] hover:bg-[#C38370] text-white font-bold py-3 px-8 rounded-full transition duration-300 text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                                Save & Publish Profile
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="bg-[#A45C40] text-[#F6EEE0] py-12">
            <div class="container mx-auto px-6 text-center">
                <p class="text-[#E4B7A0] mt-12">&copy; 2025 Akruti. All Rights Reserved.</p>
            </div>
        </footer>
    </div>

    <!-- SCRIPT BLOCK -->
    <script type="module">
        // --- FIREBASE SDK IMPORTS ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            GoogleAuthProvider,
            signInWithPopup
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore,
            doc,
            setDoc,
            getDoc,
            collection,
            getDocs
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- FIREBASE CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyAxG2Mv4v5_igF-9GSStQRoMlggSX4or30",
            authDomain: "genesis-76053.firebaseapp.com",
            projectId: "genesis-76053",
            storageBucket: "genesis-76053.appspot.com",
            messagingSenderId: "423472838278",
            appId: "1:423472838278:web:8cf5f9b0b9b38bebf60307"
        };
        
        // --- INITIALIZE FIREBASE ---
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const ticketmasterApiKey = "xAj9CGC3cKjEPT98VGlg0SzJ0M7pPyHj"; // <-- IMPORTANT: Add your key here

        // --- GLOBAL STATE ---
        let userProfile = { gigs: [] };
        let pageHistory = [];

        // --- In-memory data for art forms (from original code) ---
        const allArtForms = [
            { 
                name: "Warli Painting", 
                state: "Maharashtra", 
                status: "vulnerable", 
                practitioners: 5000, 
                description: "Monochromatic tribal art known for its geometric shapes representing the circle, triangle, and square.", 
                imageUrl: "warli.vdo.img.png", 
                videoUrl: "warli.vdo.mp4",
                detailedDescription: `
                    <h2 class="text-2xl font-bold mb-4">The Essence of Simplicity</h2>
                    <p class="mb-4">Warli painting is a form of tribal art mostly created by the tribal people from the North Sahyadri Range in Maharashtra, India. This art form is renowned for its elegant simplicity and use of basic geometric shapes: a circle, a triangle, and a square. These shapes are symbolic of nature's elements - the circle representing the sun and moon, the triangle representing mountains and pointed trees, and the square representing a sacred enclosure or a piece of land.</p>
                    <h3 class="text-xl font-bold mb-2">Technique and Materials</h3>
                    <p class="mb-4">Traditionally, Warli paintings are done on a mud base, using a white pigment made from rice paste and water, with a bamboo stick acting as a brush. The paintings depict scenes of human figures engaged in activities like hunting, dancing, sowing, and harvesting. These murals are traditionally painted on the walls of huts during festive occasions and weddings, celebrating life and the harmony between humans and nature.</p>
                `
            },
            { 
                name: "Madhubani Painting", 
                state: "Bihar", 
                status: "endangered", 
                practitioners: 2000, 
                description: "Famous for its intricate patterns and vibrant colors, traditionally created by women in the Mithila region.", 
                imageUrl: "vdo.image.madhu.png", 
                videoUrl: "madhubani.vdo.mp4",
                detailedDescription: `
                    <h2 class="text-2xl font-bold mb-4">A Legacy of Color</h2>
                    <p class="mb-4">Madhubani art, also known as Mithila painting, originated in the Mithila region of the Indian subcontinent. It is characterized by its complex geometric patterns and vibrant colors derived from natural sources. Traditionally, these paintings were created by the women of the region on the freshly plastered mud walls and floors of their homes.</p>
                    <h3 class="text-xl font-bold mb-2">Themes and Styles</h3>
                    <p class="mb-4">The themes of Madhubani paintings revolve around Hindu deities like Krishna, Rama, and Durga, as well as natural objects like the sun, moon, and religious plants like tulsi. The paintings are filled with intricate details, and no space is left empty. The art is divided into five distinct styles: Bharni, Katchni, Tantrik, Godna, and Kohbar, each with its unique characteristics and conventions.</p>
                `
            },
            { 
                name: "Pithora Painting", 
                state: "Gujarat", 
                status: "critically-endangered", 
                practitioners: 100, 
                description: "A ritualistic art form of the Rathwa tribe, characterized by vibrant colors and depictions of nature.", 
                imageUrl: "pithora.vdo.img.png", 
                videoUrl: "pithora.vdo.mp4",
                detailedDescription: `
                    <h2 class="text-2xl font-bold mb-4">Rituals on the Wall</h2>
                    <p class="mb-4">Pithora is a ritualistic painting done by the Rathwa and Bhilala tribes in Gujarat and Madhya Pradesh. It is more than an art form; it is a ritual performed to thank the gods or to ask for a wish or a boon. The entire painting, known as the Pithoro, is considered a living entity and is executed by the main male members of the community, called 'lakharas'.</p>
                    <h3 class="text-xl font-bold mb-2">Symbolism and Depiction</h3>
                    <p class="mb-4">These paintings depict a world of gods, goddesses, animals, and mythological figures. The most prominent feature is the depiction of horses, which are considered sacred. The entire painting is enclosed in a rectangular fence, which is considered the sacred boundary of the Pithoro. The vibrant colors used are made from natural pigments mixed with milk and liquor from the Mahuda tree.</p>
                `
            },
            { name: "Pattachitra", state: "Odisha", status: "vulnerable", practitioners: 3000, description: "A traditional, cloth-based scroll painting, known for its mythological narratives and folktales.", imageUrl: "f.pattachitra.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kalamkari", state: "Andhra Pradesh", status: "endangered", practitioners: 1500, description: "A type of hand-painted or block-printed cotton textile, produced in Isfahan and Indian states.", imageUrl: "f.kalamkari.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Gond Painting", state: "Madhya Pradesh", status: "vulnerable", practitioners: 4000, description: "A folk and tribal art form by the Gondi people, characterized by a sense of movement and detail.", imageUrl: "f.gond.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Tanjore Painting", state: "Tamil Nadu", status: "endangered", practitioners: 1000, description: "A classical South Indian painting style, distinguished by its dense composition, surface richness and vibrant colors.", imageUrl: "f.tanjore.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Phad Painting", state: "Rajasthan", status: "severely-endangered", practitioners: 200, description: "A religious, scroll-type art that narrates elaborate religious stories of local deities and gods.", imageUrl: "f.phad.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Cheriyal Scrolls", state: "Telangana", status: "critically-endangered", practitioners: 50, description: "A stylized version of Nakashi art, rich in the local motifs that are peculiar to the Telangana region.", imageUrl: "f.cheriyal.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kalighat Painting", state: "West Bengal", status: "nearly-extinct", practitioners: 20, description: "Originated in the 19th century as a local style that developed in the vicinity of Kalighat Kali Temple.", imageUrl: "f.kalighat.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Saura Painting", state: "Odisha", status: "endangered", practitioners: 800, description: "A style of wall mural painting associated with the Saura tribe, it has a religious significance.", imageUrl: "f.saura.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Mughal Miniature", state: "Uttar Pradesh", status: "endangered", practitioners: 500, description: "A small, brightly colored, and highly detailed painting, which grew from Persian miniature painting.", imageUrl: "f.mughal.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Mysore Painting", state: "Karnataka", status: "endangered", practitioners: 600, description: "An important form of classical South Indian painting that originated in and around the town of Mysore.", imageUrl: "f.mysore.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kerala Murals", state: "Kerala", status: "vulnerable", practitioners: 2500, description: "The frescos depicting Hindu mythology and legends, which are drawn on the walls of temples and churches.", imageUrl: "f.kerala.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Jadupatua Painting", state: "Jharkhand", status: "severely-endangered", practitioners: 30, description: "Scroll paintings by the Jadu Patuas, depicting stories of creation, mythology, and the afterlife.", imageUrl: "f,jadapatua.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kaavad Art", state: "Rajasthan", status: "endangered", practitioners: 400, description: "A portable wooden temple that has visual narratives of deities, which are hinged together.", imageUrl: "f.kavad.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Rogan Painting", state: "Gujarat", status: "critically-endangered", practitioners: 80, description: "A form of cloth printing practiced in the Kutch District of Gujarat, India.", imageUrl: "f.rogan.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Chittara Art", state: "Karnataka", status: "severely-endangered", practitioners: 150, description: "An art form practiced by the Deevaru community, living in Sagar, Karnataka.", imageUrl: "f.chitarra.png", videoUrl: "f.chitarra.mp4" },
            { name: "Manjusha Art", state: "Bihar", status: "endangered", practitioners: 700, description: "A traditional Indian art form from Bhagalpur, also known as Angika art.", imageUrl: "f,manjusha.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Thangka Painting", state: "Goa", status: "vulnerable", practitioners: 1200, description: "A Tibetan Buddhist painting on cotton, or silk appliqué, usually depicting a Buddhist deity, scene, or mandala.", imageUrl: "f.tankga.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Sanjhi Art", state: "Uttar Pradesh", status: "endangered", practitioners: 300, description: "The art of paper stenciling, often depicting Krishna's life.", imageUrl: "f.sanjhi.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Aipan Art", state: "Uttarakhand", status: "vulnerable", practitioners: 1000, description: "Ritualistic folk art drawn on floors and walls for auspicious occasions.", imageUrl: "f.aipan.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Patua Art", state: "West Bengal", status: "endangered", practitioners: 500, description: "Scroll paintings accompanied by storytelling or songs.", imageUrl: "f.patua.png", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Dokra Art", state: "Chhattisgarh", status: "vulnerable", practitioners: 3000, description: "Ancient metal casting art using the lost-wax casting technique.", imageUrl: "f.dokra.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Meenakari Craft", state: "Rajasthan", status: "vulnerable", practitioners: 5000, description: "The art of coloring and ornamenting the surface of metals by fusing over it brilliant colors.", imageUrl: "f.meenakari.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Lippan Kaam", state: "Gujarat", status: "vulnerable", practitioners: 2000, description: "A traditional mural craft of Kutch, using mud and mirrors.", imageUrl: "f.lippen.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Sikki Grass Craft", state: "Bihar", status: "vulnerable", practitioners: 4000, description: "Weaving objects from a special golden-hued grass, often depicting local folklore.", imageUrl: "f.sikki.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kolam Art", state: "Tamil Nadu", status: "vulnerable", practitioners: 10000, description: "A form of drawing that is drawn by using rice flour, chalk or chalk powder.", imageUrl: "f.kolam.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Chamba Rumal", state: "Himachal Pradesh", status: "critically-endangered", practitioners: 100, description: "An embroidered handicraft known for its intricate and beautiful needlework.", imageUrl: "f.chamba.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Pabuji Ki Phad", state: "Rajasthan", status: "severely-endangered", practitioners: 150, description: "A religious scroll painting and folk epic of Pabuji, a local hero-deity.", imageUrl: "f.pabuji.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            // { name: "Kavad Banchana", state: "Rajasthan", status: "endangered", practitioners: 250, description: "A form of oral tradition of storytelling with a portable wooden shrine.", imageUrl: "f.kavad.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Bhil Art", state: "Madhya Pradesh", status: "vulnerable", practitioners: 3500, description: "A tribal art form characterized by large, un-lifelike shapes of everyday characters filled in with earthy, yet bright colors.", imageUrl: "f.bhil.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Soof Embroidery", state: "Gujarat", status: "endangered", practitioners: 600, description: "A meticulous embroidery from Kutch that is based on the triangle, and is worked from the back of the fabric.", imageUrl: "f.soof.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Khovar and Sohrai Art", state: "Jharkhand", status: "endangered", practitioners: 900, description: "A mural art form practiced by women during weddings and harvest festivals.", imageUrl: "f.khavar.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Toda Embroidery", state: "Tamil Nadu", status: "critically-endangered", practitioners: 80, description: "A distinctive red and black embroidery of the Toda pastoral people of the Nilgiris.", imageUrl: "f.toda.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Ganjifa Cards", state: "Odisha", status: "nearly-extinct", practitioners: 40, description: "Hand-painted playing cards with intricate mythological themes.", imageUrl: "f.ganjif.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Kinnal Craft", state: "Karnataka", status: "endangered", practitioners: 200, description: "A traditional wooden craft local to the town of Kinnala, known for its vibrant toys and religious idols.", imageUrl: "f.kinnal.jpg", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Nirmal Paintings", state: "Telangana", status: "endangered", practitioners: 400, description: "A 400-year-old art form known for its golden hues and depictions of nature and mythology.", imageUrl: "f.nirmal.png", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Pipli Applique Work", state: "Odisha", status: "vulnerable", practitioners: 6000, description: "A decorative needlework where pieces of fabric are sewn onto a larger piece to create pictures.", imageUrl: "f.pipli.png", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" },
            { name: "Wood Lacquering", state: "Karnataka", status: "vulnerable", practitioners: 1500, description: "The craft of applying lacquer to wood in various colors to create decorative items and toys.", imageUrl: "f.wood.png", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" }
        ];

        const sampleEvents = [
            { name: "Warli Art Workshop", city: "Bengaluru", date: "2025-09-15", description: "Learn the basics of Warli painting from master artists.", lat: 12.9716, lon: 77.5946 },
            { name: "Madhubani Exhibition", city: "Delhi", date: "2025-10-05", description: "A grand exhibition showcasing the finest Madhubani artworks.", lat: 28.7041, lon: 77.1025 },
        ];


        // --- DOM ELEMENT SELECTORS ---
        const homePage = document.getElementById('home-page');
        const artFormsPage = document.getElementById('art-forms-page');
        const eventsPage = document.getElementById('events-page');
        const creatorHubPage = document.getElementById('creator-hub-page');
        const loginPage = document.getElementById('login-page');
        const artistsPage = document.getElementById('artists-page');
        const searchResultsPage = document.getElementById('search-results-page');
        const artDetailPage = document.getElementById('art-detail-page'); // New detail page
        const backBtn = document.getElementById('back-btn'); // Back button
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const searchBtn = document.getElementById('search-btn');
        const searchInput = document.getElementById('search-input');
        const findEventsBtn = document.getElementById('find-events-btn');
        const citySearchInput = document.getElementById('city-search-input');
        const findEventsByCityBtn = document.getElementById('find-events-by-city-btn');
        const statusFilter = document.getElementById('status-filter');
        const stateFilter = document.getElementById('state-filter');
        const filterBtn = document.getElementById('filter-btn');
        const artFormsContainer = document.getElementById('art-forms-container');
        const eventsContainer = document.getElementById('events-container');
        const featuredArtContainer = document.getElementById('featured-art-container');
        const artistsContainer = document.getElementById('artists-container');
        const searchResultsContainer = document.getElementById('search-results-container');
        
        // Auth Page Elements
        const authTitlePage = document.getElementById('auth-title-page');
        const authErrorPage = document.getElementById('auth-error-page');
        const loginFormPage = document.getElementById('login-form-page');
        const signupFormPage = document.getElementById('signup-form-page');
        const authPromptTextPage = document.getElementById('auth-prompt-text-page');
        const toggleAuthModeBtnPage = document.getElementById('toggle-auth-mode-page');

        // Auth-aware Nav Elements
        const loggedOutViews = [document.getElementById('logged-out-view'), document.getElementById('logged-out-view-mobile')];
        const loggedInViews = [document.getElementById('logged-in-view'), document.getElementById('logged-in-view-mobile')];
        const userEmailSpans = [document.getElementById('user-email'), document.getElementById('user-email-mobile')];

        // Creator Hub Form Elements
        const creatorProfileForm = document.getElementById('creator-profile-form');
        const fullNameInput = document.getElementById('full-name');
        const profilePictureUrlInput = document.getElementById('profile-picture-url');
        const artistQuoteInput = document.getElementById('artist-quote');
        const addGigBtn = document.getElementById('add-gig-btn');
        const gigFormContainer = document.getElementById('gig-form-container');
        const saveGigBtn = document.getElementById('save-gig-btn');
        const cancelGigBtn = document.getElementById('cancel-gig-btn');
        const gigsListContainer = document.getElementById('gigs-list');

        // Toast Notification Element
        const toast = document.getElementById('toast');

        // --- UI HELPER FUNCTIONS ---

        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = ``; 
            toast.classList.add(type, 'show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function updateUIForAuthState(user) {
            if (user) {
                loggedInViews.forEach(v => v.classList.remove('hidden'));
                loggedOutViews.forEach(v => v.classList.add('hidden'));
                userEmailSpans.forEach(span => {
                    span.textContent = user.email;
                    span.title = user.email;
                });
            } else {
                loggedInViews.forEach(v => v.classList.add('hidden'));
                loggedOutViews.forEach(v => v.classList.remove('hidden'));
                userEmailSpans.forEach(span => span.textContent = '');
            }
        }

        // --- PAGE NAVIGATION ---
        function hideAllPages() {
            homePage.classList.add('hidden');
            artFormsPage.classList.add('hidden');
            eventsPage.classList.add('hidden');
            creatorHubPage.classList.add('hidden');
            loginPage.classList.add('hidden');
            artistsPage.classList.add('hidden');
            searchResultsPage.classList.add('hidden');
            artDetailPage.classList.add('hidden');
        }

        function showHomePage() {
            hideAllPages();
            homePage.classList.remove('hidden');
            backBtn.classList.add('hidden');
            pageHistory = []; // Reset history when going home
        }
        
        function showArtFormsPage() {
            hideAllPages();
            artFormsPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        async function showArtistsPage() {
            hideAllPages();
            artistsPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
            const allProfiles = await fetchAllArtists();
            renderArtistProfiles(allProfiles, artistsContainer);
        }

        function showEventsPage() {
            hideAllPages();
            eventsPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showLoginPage() {
            hideAllPages();
            loginPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showSearchResultsPage() {
            hideAllPages();
            searchResultsPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }
        
        function showCreatorHubPage() {
            hideAllPages();
            creatorHubPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showArtDetailPage(artFormName) {
            const art = allArtForms.find(a => a.name === artFormName);
            if (!art) return;

            hideAllPages();
            
            document.getElementById('art-detail-title').textContent = art.name;
            document.getElementById('art-detail-description').innerHTML = art.detailedDescription;
            const videoEl = document.getElementById('art-detail-video');
            videoEl.poster = art.imageUrl;
            videoEl.innerHTML = '<source src="https://assets.mixkit.co/videos/preview/mixkit-woman-in-a-floral-dress-in-a-field-of-flowers-42228-small.mp4" type="video/mp4">';
            
            artDetailPage.classList.remove('hidden');
            backBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        const pageFunctionsMap = {
            'home-page': showHomePage,
            'art-forms-page': showArtFormsPage,
            'artists-page': showArtistsPage,
            'events-page': showEventsPage,
            'login-page': showLoginPage,
            'creator-hub-page': showCreatorHubPage,
            'search-results-page': showSearchResultsPage,
            'art-detail-page': showArtDetailPage 
        };

        function navigateTo(pageFunction, pageId, ...args) {
            const mainContent = document.getElementById('main-content');
            const currentPage = mainContent.querySelector('main:not(.hidden)');
            if (currentPage && currentPage.id !== pageId) {
                pageHistory.push(currentPage.id);
            }
            pageFunction(...args);
        }

        function handleGoBack() {
            const lastPageId = pageHistory.pop();
            const pageFunction = pageFunctionsMap[lastPageId];

            if (pageFunction) {
                pageFunction();
            } else {
                showHomePage();
            }
        }

        // --- AUTHENTICATION LOGIC ---

        onAuthStateChanged(auth, user => {
            updateUIForAuthState(user);
            if (user) {
                loadCreatorProfile(user.uid);
            } else {
                userProfile = { gigs: [] };
                creatorProfileForm.reset();
                renderGigs();
            }
        });

        async function handleSignUp(e) {
            e.preventDefault();
            const email = signupFormPage['signup-email-page'].value;
            const password = signupFormPage['signup-password-page'].value;
            authErrorPage.classList.add('hidden');

            try {
                await createUserWithEmailAndPassword(auth, email, password);
                showToast('Account created successfully!', 'success');
                showHomePage(); // Redirect to home after successful signup
            } catch (error) {
                authErrorPage.textContent = error.message;
                authErrorPage.classList.remove('hidden');
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const email = loginFormPage['login-email-page'].value;
            const password = loginFormPage['login-password-page'].value;
            authErrorPage.classList.add('hidden');

            try {
                await signInWithEmailAndPassword(auth, email, password);
                showToast('Logged in successfully!', 'success');
                showHomePage(); // Redirect to home after successful login
            } catch (error) {
                authErrorPage.textContent = error.message;
                authErrorPage.classList.remove('hidden');
            }
        }
        
        async function handleGoogleLogin() {
            const provider = new GoogleAuthProvider();
            authErrorPage.classList.add('hidden');
            try {
                await signInWithPopup(auth, provider);
                showToast('Logged in with Google successfully!', 'success');
                showHomePage();
            } catch (error) {
                console.error("Google Sign-in Error:", error);
                authErrorPage.textContent = `Google Sign-in failed: ${error.message}`;
                authErrorPage.classList.remove('hidden');
            }
        }

        function handleLogout() {
            signOut(auth).then(() => {
                showToast('You have been logged out.');
                if (!homePage.classList.contains('hidden')) {
                   // do nothing, already on home
                } else {
                   showHomePage();
                }
            });
        }

        // --- CREATOR HUB & FIRESTORE LOGIC ---

        async function loadCreatorProfile(userId) {
            const docRef = doc(db, "profiles", userId);
            try {
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    userProfile = docSnap.data();
                    userProfile.gigs = userProfile.gigs || [];
                    fullNameInput.value = userProfile.fullName || '';
                    profilePictureUrlInput.value = userProfile.profilePictureUrl || '';
                    artistQuoteInput.value = userProfile.artistQuote || '';
                    renderGigs();
                } else {
                    console.log("No profile found for this user.");
                    userProfile = { gigs: [] }; 
                }
            } catch (error) {
                console.error("Error loading profile:", error);
                showToast("Could not load your profile.", "error");
            }
        }
        
        async function handleSaveProfile(e) {
            e.preventDefault();
            const user = auth.currentUser;
            if (!user) {
                showToast("You must be logged in to save a profile.", "error");
                return;
            }

            userProfile.fullName = fullNameInput.value;
            userProfile.profilePictureUrl = profilePictureUrlInput.value;
            userProfile.artistQuote = artistQuoteInput.value;
            userProfile.email = user.email; // Save the user's email
            
            const docRef = doc(db, "profiles", user.uid);
            try {
                await setDoc(docRef, userProfile, { merge: true });
                showToast("Profile saved successfully!", "success");
            } catch (error) {
                console.error("Error saving profile:", error);
                showToast("There was an error saving your profile.", "error");
            }
        }

        function renderGigs() {
            gigsListContainer.innerHTML = '';
            if (!userProfile.gigs || userProfile.gigs.length === 0) {
                 gigsListContainer.innerHTML = '<p class="text-center text-[#C38370]">You haven\'t added any services yet.</p>';
                 return;
            }
            userProfile.gigs.forEach((gig, index) => {
                const gigEl = document.createElement('div');
                gigEl.className = 'flex justify-between items-center bg-white p-4 rounded-lg border border-[#E4B7A0]';
                gigEl.innerHTML = `
                    <p class="font-medium">${gig.title}</p>
                    <div>
                        <button type="button" data-action="delete-gig" data-index="${index}" class="text-[#A45C40] hover:text-red-600"><i class="fas fa-trash-alt"></i></button>
                    </div>
                `;
                gigsListContainer.appendChild(gigEl);
            });
        }

        function handleSaveGig() {
            const newGig = {
                title: document.getElementById('gig-title').value,
                description: document.getElementById('gig-description').value,
                pricing: {
                    basic: { price: document.getElementById('basic-price').value, desc: document.getElementById('basic-desc').value },
                    standard: { price: document.getElementById('standard-price').value, desc: document.getElementById('standard-desc').value },
                    premium: { price: document.getElementById('premium-price').value, desc: document.getElementById('premium-desc').value },
                }
            };

            if (!newGig.title) {
                showToast("Service title is required.", "error");
                return;
            }
            
            userProfile.gigs.push(newGig);
            renderGigs();
            gigFormContainer.classList.add('hidden');
            gigFormContainer.parentElement.querySelector('form').reset();
        }

        function handleDeleteGig(index) {
             userProfile.gigs.splice(index, 1);
             renderGigs();
             showToast("Service removed. Remember to save your profile.", "success");
        }

        // --- ARTISTS & SEARCH LOGIC ---

        async function fetchAllArtists(searchQuery = '') {
            const profilesRef = collection(db, "profiles");
            let allProfiles = [];
            try {
                const querySnapshot = await getDocs(profilesRef);
                querySnapshot.forEach((doc) => {
                    allProfiles.push(doc.data());
                });

                if (searchQuery) {
                    const lowercasedQuery = searchQuery.toLowerCase();
                    const filteredProfiles = allProfiles.filter(profile => {
                        const nameMatch = profile.fullName?.toLowerCase().includes(lowercasedQuery);
                        const quoteMatch = profile.artistQuote?.toLowerCase().includes(lowercasedQuery);
                        const gigMatch = profile.gigs?.some(gig => 
                            gig.title?.toLowerCase().includes(lowercasedQuery) || 
                            gig.description?.toLowerCase().includes(lowercasedQuery)
                        );
                        return nameMatch || quoteMatch || gigMatch;
                    });
                    return filteredProfiles;
                }
                return allProfiles;
            } catch (error) {
                console.error("Error fetching artist profiles:", error);
                showToast("Could not fetch artist profiles.", "error");
                return [];
            }
        }
        
        function renderArtistProfiles(profiles, container) {
            container.innerHTML = '';
            if (profiles.length === 0) {
                container.innerHTML = '<p class="text-center text-[#C38370] col-span-full">No artists found.</p>';
                return;
            }

            profiles.forEach(profile => {
                if (!profile.fullName) return; // Skip profiles without a name

                const gigsHTML = profile.gigs?.map(gig => `
                    <div class="mt-2">
                        <h4 class="font-semibold text-[#A45C40]">${gig.title}</h4>
                        <p class="text-sm text-[#C38370]">${gig.description}</p>
                    </div>
                `).join('') || '<p class="text-sm text-[#C38370]">No services listed.</p>';

                const artistCard = document.createElement('div');
                artistCard.className = 'bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow flex flex-col items-center text-center';
                artistCard.innerHTML = `
                    <img src="${profile.profilePictureUrl || 'https://placehold.co/128x128/F6EEE0/A45C40?text=Artist'}" alt="${profile.fullName}" class="w-32 h-32 rounded-full object-cover mb-4 border-4 border-[#E4B7A0]">
                    <h3 class="text-2xl font-bold mb-2">${profile.fullName}</h3>
                    <a href="mailto:${profile.email}" class="text-sm text-[#C38370] hover:underline mb-4">${profile.email}</a>
                    <p class="text-[#A45C40] font-normal mb-4 text-lg">"${profile.artistQuote || 'No bio available.'}"</p>
                    <div class="border-t border-[#E4B7A0] pt-4 w-full">
                        <h4 class="font-bold text-lg mb-2">Services:</h4>
                        ${gigsHTML}
                    </div>
                `;
                container.appendChild(artistCard);
            });
        }

        async function handleArtistSearch() {
            const query = searchInput.value;
            if (!query.trim()) {
                showToast("Please enter a search term.", "error");
                return;
            }
            navigateTo(() => {
                showSearchResultsPage();
                fetchAllArtists(query).then(results => {
                    renderArtistProfiles(results, searchResultsContainer);
                });
            }, 'search-results-page');
        }


        // --- ORIGINAL WEBSITE LOGIC (RENDERING, FILTERS, ETC.) ---
        
        function renderArtForms(forms) {
            artFormsContainer.innerHTML = '';
            if (forms.length === 0) {
                artFormsContainer.innerHTML = '<p class="text-center text-[#C38370] col-span-full">No art forms match your criteria.</p>';
                return;
            }
            forms.forEach(art => {
                const artEl = document.createElement('div');
                artEl.className = 'art-form-item';
                artEl.dataset.status = art.status;
                artEl.dataset.state = art.state;

                const hasRealVideo = art.videoUrl && !art.videoUrl.includes('mixkit.co');

                const mediaElementHTML = hasRealVideo 
                    ? `<video class="w-full h-full object-cover" poster="${art.imageUrl}" muted loop>
                           <source src="${art.videoUrl}" type="video/mp4">
                           Your browser does not support the video tag.
                       </video>`
                    : `<img src="${art.imageUrl}" alt="${art.name}" class="w-full h-full object-cover transition-transform duration-[2000ms] ease-in-out group-hover:scale-110">`;

                artEl.innerHTML = `
                    <div class="flex flex-col md:flex-row items-center bg-white p-8 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 group">
                        <div class="w-full md:w-1/3 h-64 rounded-lg mb-6 md:mb-0 md:mr-8 overflow-hidden">
                           ${mediaElementHTML}
                        </div>
                        <div class="flex-1 text-left">
                            <span class="inline-block bg-[#E4B7A0]/40 text-[#A45C40] text-sm font-semibold px-3 py-1 rounded-full mb-2 capitalize">${art.status.replace('-', ' ')}</span>
                            <h2 class="text-3xl font-bold mb-2">${art.name}</h2>
                            <p class="text-[#C38370] mb-4"><i class="fas fa-map-marker-alt mr-2 text-[#E4B7A0]"></i>${art.state}</p>
                            <p class="text-[#A45C40] mb-4">${art.description}</p>
                            <p class="text-sm text-red-600 font-semibold">Estimated Practitioners Left: ~${art.practitioners}</p>
                        </div>
                    </div>
                `;
                artFormsContainer.appendChild(artEl);
                
                if (hasRealVideo) {
                    const video = artEl.querySelector('video');
                    const card = artEl.querySelector('.group');
                    card.addEventListener('mouseover', () => video.play());
                    card.addEventListener('mouseout', () => video.pause());
                }
            });
        }
        
        function populateFilters() {
            const states = [...new Set(allArtForms.map(art => art.state))].sort();
            stateFilter.innerHTML = '<option value="all">Filter by State</option>';
            states.forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.textContent = state;
                stateFilter.appendChild(option);
            });
        }

        function handleArtFormFilter() {
            const selectedStatus = statusFilter.value;
            const selectedState = stateFilter.value;

            let filteredForms = allArtForms;

            if (selectedStatus !== 'all') {
                filteredForms = filteredForms.filter(art => art.status === selectedStatus);
            }
            if (selectedState !== 'all') {
                filteredForms = filteredForms.filter(art => art.state === selectedState);
            }
            
            renderArtForms(filteredForms);
        }

        function renderEvents(events) {
            eventsContainer.innerHTML = '';
            if (!events || events.length === 0) {
                eventsContainer.innerHTML = '<p class="text-center text-[#C38370] col-span-full">No events found nearby.</p>';
                return;
            }
            events.forEach(event => {
                const eventCard = document.createElement('div');
                eventCard.className = 'bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow';
                eventCard.innerHTML = `
                    <h3 class="text-xl font-bold mb-2">${event.name}</h3>
                    <p class="text-[#C38370] mb-2"><i class="fas fa-calendar-alt mr-2"></i>${new Date(event.date).toDateString()}</p>
                    <p class="text-[#C38370] mb-4"><i class="fas fa-map-marker-alt mr-2"></i>${event.city}</p>
                    <p class="text-[#A45C40]">${event.description}</p>
                `;
                eventsContainer.appendChild(eventCard);
            });
        }

        async function findNearbyEvents() {
            if (!navigator.geolocation) {
                showToast("Geolocation is not supported by your browser.", "error");
                return;
            }

            navigator.geolocation.getCurrentPosition(async position => {
                const { latitude, longitude } = position.coords;
                
                const url = `https://app.ticketmaster.com/discovery/v2/events.json?apikey=${ticketmasterApiKey}&latlong=${latitude},${longitude}&radius=50&unit=km&classificationName=Arts & Theatre`;

                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Failed to fetch events from Ticketmaster API.');
                    }
                    const data = await response.json();
                    
                    const formattedEvents = data._embedded?.events.map(event => ({
                        name: event.name,
                        city: event._embedded?.venues[0]?.city?.name || 'N/A',
                        date: event.dates.start.localDate,
                        description: event.info || 'No description available.'
                    })) || [];

                    renderEvents(formattedEvents);

                } catch (error) {
                    console.error("Error fetching events:", error);
                    showToast("Could not fetch nearby events.", "error");
                    renderEvents([]); // Render an empty state
                }

            }, () => {
                showToast("Unable to retrieve your location.", "error");
            });
        }

        function renderFeaturedArtForms() {
            const featuredArtNames = ["Warli Painting", "Pithora Painting", "Madhubani Painting"];
            const featuredForms = allArtForms.filter(art => featuredArtNames.includes(art.name));

            featuredArtContainer.innerHTML = '';
            featuredForms.forEach(art => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300 text-left group cursor-pointer";
                card.dataset.action = "show-art-detail";
                card.dataset.artform = art.name;
                
                const hasRealVideo = art.videoUrl && !art.videoUrl.includes('mixkit.co');
                const mediaElementHTML = hasRealVideo 
                    ? `<video class="w-full h-full object-cover pointer-events-none" poster="${art.imageUrl}" muted loop>
                           <source src="${art.videoUrl}" type="video/mp4">
                       </video>`
                    : `<img src="${art.imageUrl}" alt="${art.name}" class="w-full h-full object-cover transition-transform duration-[2000ms] ease-in-out group-hover:scale-110 pointer-events-none">`;

                card.innerHTML = `
                    <div class="w-full h-56 overflow-hidden">
                        ${mediaElementHTML}
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">${art.name}</h3>
                        <p class="text-[#C38370] text-sm mb-4">${art.state}</p>
                        <p class="text-[#A45C40] text-base">${art.description}</p>
                    </div>
                `;
                featuredArtContainer.appendChild(card);
                
                if (hasRealVideo) {
                    const video = card.querySelector('video');
                    card.addEventListener('mouseover', () => video.play());
                    card.addEventListener('mouseout', () => video.pause());
                }
            });
        }
        
        // --- GLOBAL EVENT LISTENER (EVENT DELEGATION) ---
        document.addEventListener('click', (e) => {
            const target = e.target.closest('[data-action]');
            if (!target) return;

            const action = target.dataset.action;
            
            switch(action) {
                case 'show-login':
                    navigateTo(showLoginPage, 'login-page');
                    break;
                case 'login-google':
                    handleGoogleLogin();
                    break;
                case 'logout':
                    handleLogout();
                    break;
                case 'creator-hub':
                    if (auth.currentUser) {
                        navigateTo(showCreatorHubPage, 'creator-hub-page');
                    } else {
                        navigateTo(showLoginPage, 'login-page');
                        showToast("Please log in to access the Creator Hub.", "error");
                    }
                    break;
                case 'show-home':
                    e.preventDefault();
                    showHomePage();
                    break;
                case 'show-art-forms':
                    e.preventDefault();
                    navigateTo(() => renderArtForms(allArtForms), 'art-forms-page');
                    showArtFormsPage();
                    break;
                case 'show-artists':
                    e.preventDefault();
                    navigateTo(showArtistsPage, 'artists-page');
                    break;
                case 'show-art-detail':
                    const artFormName = target.dataset.artform;
                    navigateTo(() => showArtDetailPage(artFormName), 'art-detail-page');
                    break;
                case 'show-events':
                    e.preventDefault();
                    navigateTo(() => renderEvents([]), 'events-page'); // Show empty state initially
                    showEventsPage();
                    break;
                case 'delete-gig':
                    const index = parseInt(target.dataset.index, 10);
                    handleDeleteGig(index);
                    break;
                case 'search':
                    handleArtistSearch();
                    break;
                case 'go-back':
                    handleGoBack();
                    break;
            }
        });

        // --- OTHER EVENT LISTENERS ---
        mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
        searchInput.addEventListener('keypress', (e) => e.key === 'Enter' && handleArtistSearch());
        filterBtn.addEventListener('click', handleArtFormFilter);
        findEventsBtn.addEventListener('click', findNearbyEvents);

        // Auth Page Listeners
        toggleAuthModeBtnPage.addEventListener('click', () => {
            const isLogin = signupFormPage.classList.contains('hidden');
            loginFormPage.classList.toggle('hidden', !isLogin);
            signupFormPage.classList.toggle('hidden', isLogin);
            authTitlePage.textContent = isLogin ? 'Sign Up' : 'Login';
            authPromptTextPage.textContent = isLogin ? "Already have an account?" : "Don't have an account?";
            toggleAuthModeBtnPage.textContent = isLogin ? 'Login' : 'Sign Up';
            authErrorPage.classList.add('hidden');
        });

        // Form Submission Listeners
        loginFormPage.addEventListener('submit', handleLogin);
        signupFormPage.addEventListener('submit', handleSignUp);
        creatorProfileForm.addEventListener('submit', handleSaveProfile);

        // Creator Hub - Gig Form Listeners
        addGigBtn.addEventListener('click', () => gigFormContainer.classList.remove('hidden'));
        cancelGigBtn.addEventListener('click', () => gigFormContainer.classList.add('hidden'));
        saveGigBtn.addEventListener('click', handleSaveGig);
        
        // --- INITIALIZATION ---
        function init() {
            window.addEventListener('load', () => {
                setTimeout(() => {
                    const navLogo = document.querySelector('#home-link img');
                    const splashLogo = document.getElementById('splash-logo');
                    if (!navLogo || !splashLogo) return;

                    const splashRect = splashLogo.getBoundingClientRect();
                    const navRect = navLogo.getBoundingClientRect();

                    const scale = navRect.width / splashRect.width;
                    const translateX = navRect.left - splashRect.left;
                    const translateY = navRect.top - splashRect.top;

                    splashLogo.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
                    document.body.classList.add('loaded');

                    setTimeout(() => {
                        document.getElementById('splash-screen').style.display = 'none';
                    }, 500);
                }, 500);
            });

            showHomePage();
            populateFilters();
            renderFeaturedArtForms();
        }
        
        init();

    </script>
</body>
</html>
