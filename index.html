<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalakriti - A Celebration of Indian Folk Art</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #fb923c;
            transition: width 0.3s;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://placehold.co/1920x1080/334155/ffffff?text=Indian+Folk+Art');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" id="home-link" class="text-2xl font-bold text-slate-800 cursor-pointer">
                <i class="fas fa-palette text-orange-500"></i> Kalakriti
            </a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#home-page-section" class="nav-link text-slate-600 hover:text-orange-500 font-medium">Home</a>
                <a href="#art-forms" class="nav-link text-slate-600 hover:text-orange-500 font-medium">Art Forms</a>
            </div>
            <div class="hidden md:flex items-center space-x-4" id="nav-right-desktop">
                <!-- This content is managed by JavaScript -->
            </div>
            <button id="mobile-menu-button" class="md:hidden">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <div id="nav-right-mobile">
                <!-- This content is managed by JavaScript -->
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT WRAPPER -->
    <div id="main-content">
        
        <!-- =================================== -->
        <!-- ==        HOME PAGE CONTENT      == -->
        <!-- =================================== -->
        <main id="home-page">
            <!-- Hero Section -->
            <section id="home-page-section" class="hero-section text-white h-[calc(100vh-64px)] flex items-center justify-center">
                <div class="text-center max-w-3xl mx-auto px-4">
                    <h1 class="text-4xl md:text-6xl font-bold mb-4 leading-tight">Rediscover the Soul of India</h1>
                    <p class="text-lg md:text-xl mb-8">A digital canvas preserving and promoting the vibrant legacy of India's traditional folk art.</p>
                    <a href="#art-forms" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300">Explore Art Forms</a>
                </div>
            </section>

            <!-- Featured Art Forms -->
            <section id="art-forms" class="py-20 bg-white">
                <div class="container mx-auto px-6 text-center">
                    <h2 class="text-3xl font-bold mb-4">Featured Art Forms</h2>
                    <p class="text-slate-600 max-w-2xl mx-auto mb-12">Journey through a curated selection of India's most cherished artistic traditions.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <!-- Art Form Cards will be populated here -->
                    </div>
                </div>
            </section>
        </main>

        <!-- =================================== -->
        <!-- ==      CREATOR HUB CONTENT      == -->
        <!-- =================================== -->
        <main id="creator-hub-page" class="hidden bg-white">
            <div class="container mx-auto px-6 py-20">
                <div class="max-w-3xl mx-auto text-center">
                    <h1 class="text-4xl font-bold mb-4">Creator Hub</h1>
                    <p class="text-slate-600 mb-12">This is your creative space. Fill out the sections below to build and publish your public artist profile.</p>
                </div>

                <div class="max-w-3xl mx-auto space-y-12">
                    <!-- Artist Details Card -->
                    <div class="bg-slate-50 p-8 rounded-lg shadow-md">
                        <h2 class="text-2xl font-bold mb-6">1. My Details</h2>
                        <div class="space-y-6">
                            <div>
                                <label for="full-name" class="block font-medium text-slate-700 mb-2">Full Name</label>
                                <input type="text" id="full-name" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 transition" placeholder="e.g., Sunita Devi">
                            </div>
                            <div>
                                <label for="artist-quote" class="block font-medium text-slate-700 mb-2">Short Quote or Bio</label>
                                <textarea id="artist-quote" rows="3" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 transition" placeholder="e.g., 'I paint the stories my grandmother told me...'"></textarea>
                            </div>
                        </div>
                    </div>
                    <!-- Save Button -->
                    <div class="flex justify-center pt-8">
                        <button id="save-profile-btn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-full transition duration-300 text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                            Save & Publish Profile
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- =================================== -->
        <!-- ==         LOGIN PAGE CONTENT      == -->
        <!-- =================================== -->
        <main id="login-page" class="hidden">
            <div class="min-h-[calc(100vh-128px)] flex items-center justify-center bg-slate-50 py-12 px-4 sm:px-6 lg:px-8">
                <div class="max-w-md w-full space-y-8 bg-white p-10 rounded-xl shadow-lg">
                    <div>
                        <h2 class="mt-6 text-center text-3xl font-bold text-slate-800">
                            Welcome Back
                        </h2>
                    </div>
                    <div class="mt-8 space-y-6">
                        <button id="google-signin-btn" class="group relative w-full flex justify-center items-center py-2 px-4 border border-slate-300 text-sm font-medium rounded-md text-slate-700 bg-white hover:bg-slate-50 focus:outline-none">
                            <img class="h-5 w-5 mr-2" src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google logo">
                            Sign in with Google
                        </button>
                    </div>
                    <!-- NEW: Error message display -->
                    <div id="login-error" class="text-red-500 text-center text-sm font-medium mt-4 hidden"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-800 text-white py-12">
        <div class="container mx-auto px-6 text-center">
            <p class="text-slate-400">&copy; 2025 Kalakriti. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- SCRIPT BLOCK -->
    <script type="module">
        // Your web app's Firebase configuration
        const firebaseConfig = {
        //   apiKey: "AIzaSyAxG2Mv4v5_igF-9GSStQRoM1ggSX4or30",
        //   authDomain: "genesis-76053.firebaseapp.com",
        //   projectId: "genesis-76053",
        //   storageBucket: "genesis-76053.appspot.com",
        //   messagingSenderId: "423472838278",
        //   appId: "1:423472838278:web:8cf5f9b0b9b38bebf60307"

          apiKey: "AIzaSyAxG2Mv4v5_igF-9GSStQRoMlggSX4or30",
          authDomain: "genesis-76053.firebaseapp.com",
          projectId: "genesis-76053",
          storageBucket: "genesis-76053.firebasestorage.app",
          messagingSenderId: "423472838278",
          appId: "1:423472838278:web:8cf5f9b0b9b38bebf60307",
          measurementId: "G-KGKB3F175X"

        };

        // Initialize Firebase
        const { initializeApp } = await import('https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js');
        const { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } = await import('https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js');
        const { getFirestore, doc, setDoc, getDoc } = await import('https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js');

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();
        
        // --- All application logic is now inside this single module script ---

        // Page containers
        const homePage = document.getElementById('home-page');
        const creatorHubPage = document.getElementById('creator-hub-page');
        const loginPage = document.getElementById('login-page');
        
        // Buttons and Links
        const homeLink = document.getElementById('home-link');
        const navLinks = document.querySelectorAll('.nav-link');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const googleSignInBtn = document.getElementById('google-signin-btn');
        const saveProfileBtn = document.getElementById('save-profile-btn');
        const loginErrorDiv = document.getElementById('login-error');

        // UI containers for Auth State
        const navRightDesktop = document.getElementById('nav-right-desktop');
        const navRightMobile = document.getElementById('nav-right-mobile');

        let currentUser = null;

        function hideAllPages() {
            homePage.classList.add('hidden');
            creatorHubPage.classList.add('hidden');
            loginPage.classList.add('hidden');
        }

        function showCreatorHub() {
            if (!currentUser) {
                showLoginPage();
                return;
            }
            hideAllPages();
            creatorHubPage.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showHomePage() {
            hideAllPages();
            homePage.classList.remove('hidden');
        }

        function showLoginPage() {
            hideAllPages();
            loginPage.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function updateUIForLoggedInUser(user) {
            navRightDesktop.innerHTML = `
                <span class="font-medium text-slate-700">Welcome, ${user.displayName.split(' ')[0]}</span>
                <img src="${user.photoURL}" class="h-8 w-8 rounded-full">
                <button data-action="logout" class="text-slate-600 hover:text-orange-500 font-medium">Logout</button>
                <button data-action="creator-hub" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-full transition duration-300">Creator Hub</button>
            `;
             navRightMobile.innerHTML = `
                <span class="block py-2 font-medium text-slate-700">Welcome, ${user.displayName.split(' ')[0]}</span>
                <button data-action="logout" class="block w-full text-left py-2 text-slate-600 hover:text-orange-500">Logout</button>
                <button data-action="creator-hub" class="block w-full mt-2 bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-full text-center">Creator Hub</button>
            `;
        }

        function updateUIForLoggedOutUser() {
            navRightDesktop.innerHTML = `
                <button data-action="login" class="text-slate-600 hover:text-orange-500 font-medium">Login</button>
                <button data-action="creator-hub" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-full transition duration-300">Creator Hub</button>
            `;
             navRightMobile.innerHTML = `
                <button data-action="login" class="block w-full text-left py-2 text-slate-600 hover:text-orange-500">Login</button>
                <button data-action="creator-hub" class="block w-full mt-2 bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-full text-center">Creator Hub</button>
            `;
        }

        async function loadCreatorData(userId) {
            const docRef = doc(db, "artists", userId);
            const docSnap = await getDoc(docRef);

            if (docSnap.exists()) {
                const data = docSnap.data();
                document.getElementById('full-name').value = data.fullName || '';
                document.getElementById('artist-quote').value = data.bio || '';
            } else {
                console.log("No profile data found for this user.");
            }
        }

        // --- AUTHENTICATION HANDLERS ---
        const handleGoogleSignIn = async () => {
            loginErrorDiv.classList.add('hidden'); // Hide previous errors
            try {
                await signInWithPopup(auth, provider);
                showHomePage(); // Go to home page after login
            } catch (error) {
                console.error("Google Sign-In Error:", error);
                // Display a user-friendly error message
                let errorMessage = "An unknown error occurred. Please try again.";
                if (error.code === 'auth/popup-closed-by-user') {
                    errorMessage = "You closed the sign-in window. Please try again.";
                } else if (error.code === 'auth/cancelled-popup-request') {
                    errorMessage = "Sign-in was cancelled. Please try again.";
                } else if (error.code === 'auth/popup-blocked') {
                    errorMessage = "Pop-up blocked! Please allow pop-ups for this site and try again.";
                } else if (error.code) {
                     errorMessage = `Error: ${error.code}. Please check your Firebase configuration and authorized domains.`;
                }
                loginErrorDiv.textContent = errorMessage;
                loginErrorDiv.classList.remove('hidden');
            }
        };

        const handleSignOut = async () => {
            try {
                await signOut(auth);
                showHomePage();
            } catch (error) {
                console.error("Sign Out Error:", error);
            }
        };

        const handleSaveProfile = async () => {
            if (!currentUser) {
                alert("You must be logged in to save your profile.");
                return;
            }
            const fullName = document.getElementById('full-name').value;
            const bio = document.getElementById('artist-quote').value;

            try {
                await setDoc(doc(db, "artists", currentUser.uid), {
                    fullName: fullName,
                    bio: bio,
                    email: currentUser.email
                }, { merge: true });
                alert("Profile saved successfully!");
            } catch (error) {
                console.error("Error saving profile: ", error);
                alert("There was an error saving your profile.");
            }
        };

        // --- MAIN AUTH STATE LISTENER ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                updateUIForLoggedInUser(user);
                loadCreatorData(user.uid);
            } else {
                currentUser = null;
                updateUIForLoggedOutUser();
            }
        });
        
        // --- GLOBAL EVENT LISTENER (EVENT DELEGATION) ---
        document.addEventListener('click', (e) => {
            const action = e.target.closest('[data-action]')?.dataset.action;
            if (action === 'login') showLoginPage();
            if (action === 'creator-hub') showCreatorHub();
            if (action === 'logout') handleSignOut();
        });

        // --- INITIAL EVENT LISTENERS ---
        googleSignInBtn.addEventListener('click', handleGoogleSignIn);
        saveProfileBtn.addEventListener('click', handleSaveProfile);
        homeLink.addEventListener('click', (e) => {
            e.preventDefault();
            showHomePage();
            window.scrollTo(0, 0);
        });
        navLinks.forEach(link => {
            link.addEventListener('click', showHomePage);
        });
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
    </script>
</body>
</html>
